(window.webpackJsonp=window.webpackJsonp||[]).push([[17,6,7],{453:function(t,e,r){var content=r(456);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(22).default)("c2fd3238",content,!0,{sourceMap:!1})},455:function(t,e,r){"use strict";r(453)},456:function(t,e,r){var n=r(21)(!1);n.push([t.i,".logo-image{width:140px;height:44px;cursor:pointer}",""]),t.exports=n},457:function(t,e,r){"use strict";r.r(e);var n={methods:{toIndex:function(){this.$router.push("/")}}},o=(r(455),r(60)),component=Object(o.a)(n,(function(){var t=this;return(0,t._self._c)("img",{staticClass:"logo-image",attrs:{alt:"logo",src:"/image/logo.png"},on:{click:function(e){return t.toIndex()}}})}),[],!1,null,null,null);e.default=component.exports},458:function(t,e,r){"use strict";r.r(e);var n=r(211),o=r(197),c=r(195),l=r(127),v=r(57),_=r(517),d=(r(29),r(14)),f=(r(64),{methods:{logout:function(){var t=this;return Object(d.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$auth.logout("user");case 3:window.location.href="/login",e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))()}}}),h=r(60),component=Object(h.a)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-right"},[e(_.a,{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(r){var c=r.on,l=r.attrs;return[t.$auth.loggedIn?e(n.a,t._g(t._b({staticClass:"black--text",attrs:{color:"white",dark:""}},"v-btn",l,!1),c),[t._v("\n          "+t._s(t.$auth.user.name)+"\n          "),e(o.a,[t._v("mdi-chevron-down")])],1):t._e(),t._v(" "),t.$auth.loggedIn?t._e():e(n.a,t._g(t._b({staticClass:"black--text",attrs:{color:"white",dark:""}},"v-btn",l,!1),c),[t._v("\n          メニュー\n          "),e(o.a,[t._v("mdi-chevron-down")])],1)]}}])},[t._v(" "),t.$auth.loggedIn?e(c.a,[e(l.a,{attrs:{link:"",to:"/"}},[e(v.b,[t._v("ホーム")])],1),t._v(" "),e(l.a,{attrs:{link:"",to:"/mypage"}},[e(v.b,[t._v("マイページ")])],1),t._v(" "),e(l.a,{on:{click:function(e){return t.logout()}}},[e(v.b,[t._v("ログアウト")])],1)],1):t._e(),t._v(" "),t.$auth.loggedIn?t._e():e(c.a,[e(l.a,{attrs:{link:"",to:"/"}},[e(v.b,[t._v("ホーム")])],1),t._v(" "),e(l.a,{attrs:{link:"",to:"/register"}},[e(v.b,[t._v("会員登録")])],1),t._v(" "),e(l.a,{attrs:{link:"",to:"/login"}},[e(v.b,[t._v("ログイン")])],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports},576:function(t,e,r){"use strict";r.r(e);var n=r(211),o=r(464),c=r(452),l=r(566),v=r(477),_=r(197),d=r(166),f=r(193),h=r(565),m=r(509),x=r(448),w=(r(29),r(14)),C=(r(212),r(171),r(64),{middleware:"auth",data:function(){return{favorites:[],reservations:[],cancelOverlay:!1,index:"",reservation_id:"",favoriteMessage:"",reservationMessage:""}},methods:{getReservations:function(){var t=this;return Object(w.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/api/v1/users/".concat(t.$auth.user.id,"/reservations")).then((function(e){t.reservations=e.data.reservations,0==t.reservations.length&&(t.reservationMessage="予約はありません。"),console.log(t.reservations)})).catch((function(t){console.log(t.response)}));case 2:case"end":return e.stop()}}),e)})))()},getFavorites:function(){var t=this;return Object(w.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/api/v1/users/".concat(t.$auth.user.id,"/favorites")).then((function(e){t.favorites=e.data.favorites,0==t.favorites.length&&(t.favoriteMessage="お気に入り店舗はありません。")})).catch((function(t){console.log(t.response)}));case 2:case"end":return e.stop()}}),e)})))()},like:function(t){var e=this;return Object(w.a)(regeneratorRuntime.mark((function r(){var body;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return body={shop_id:t.id,user_id:e.$auth.user.id},r.next=3,e.$axios.post("/api/v1/favorites/",body).then((function(t){console.log(t),e.favorites.push(t.data.favorites)})).catch((function(t){console.log(t.response)}));case 3:case"end":return r.stop()}}),r)})))()},unlike:function(t){var e=this;return Object(w.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$axios.delete("/api/v1/favorites/"+t).then((function(r){var n=e.favorites.findIndex((function(e){return e.id===t}));e.favorites.splice(n,1)})).catch((function(t){console.log(t.response)}));case 2:case"end":return r.stop()}}),r)})))()},openCancelOverlay:function(t,e){this.cancelOverlay=!0,this.index=t+1,this.reservation_id=e},closeCancelOverlay:function(){this.cancelOverlay=!1},cancelReservation:function(t){var e=this;return Object(w.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$axios.delete("/api/v1/reservations/"+t).then((function(r){e.cancelOverlay=!1;var n=e.reservations.findIndex((function(e){return e.id===t}));e.reservations.splice(n,1)})).catch((function(t){console.log(t.response)}));case 2:case"end":return r.stop()}}),r)})))()}},created:function(){this.getReservations(),this.getFavorites()}}),k=r(60),component=Object(k.a)(C,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"align-center d-flex justify-space-between mt-4 mb-5"},[e("Logo"),t._v(" "),e("LoginMenu")],1),t._v(" "),e("h2",{staticClass:"mt-5 pt-5"},[t._v(t._s(t.$auth.user.name)+"さん")]),t._v(" "),e(h.a,{staticClass:"mb-5"},[e(f.a,{attrs:{value:t.cancelOverlay}},[e(o.a,{staticClass:"pb-3 pt-5 pr-5 pl-5",attrs:{light:""}},[e("div",{},[t._v("\n          予約"+t._s(t.index)+"を取り消します。よろしいですか？\n        ")]),t._v(" "),e("div",{staticClass:"text-center pb-3 mt-5"},[e(n.a,{attrs:{color:"blue accent-4 white--text pl-5 pr-5 mr-2"},on:{click:function(e){return t.cancelReservation(t.reservation_id)}}},[t._v("取り消しする")]),t._v(" "),e(n.a,{attrs:{color:"black white--text"},on:{click:function(e){return t.closeCancelOverlay()}}},[t._v("キャンセル")])],1)])],1),t._v(" "),e(l.a,{attrs:{cols:"12",xs:"12",sm:"12",md:"5"}},[e("h3",{staticClass:"mt-5 mb-3"},[t._v("予約状況")]),t._v(" "),e("p",[t._v(t._s(t.reservationMessage))]),t._v(" "),e(h.a,t._l(t.reservations,(function(r,d){return e(l.a,{key:r.id,attrs:{cols:"12"}},[e(o.a,{staticClass:"reservation-card"},[e(c.b,{staticClass:"pb-2 pt-2"},[e(_.a,{staticClass:"mr-2",attrs:{color:"black"}},[t._v("mdi-clock")]),t._v("予約"),e("span",{staticClass:"ml-1"},[t._v(t._s(d+1))])],1),t._v(" "),e(v.a),t._v(" "),e(m.a,{staticClass:"table reservation-table"},[e("tbody",[e("tr",[e("th",{staticClass:"text-left bg-gray border-top"},[t._v("店名")]),t._v(" "),e("td",{staticClass:"border-top bg-white"},[t._v(t._s(r.shops.name))])]),t._v(" "),e("tr",[e("th",{staticClass:"text-left bg-gray"},[t._v("予約日")]),t._v(" "),e("td",{staticClass:"bg-white"},[t._v(t._s(t.$dateFns.format(new Date(r.date.substr(0,10)),"Y年M月d日")))])]),t._v(" "),e("tr",[e("th",{staticClass:"text-left bg-gray"},[t._v("時間")]),t._v(" "),e("td",{staticClass:"bg-white"},[t._v(t._s(t.$dateFns.format(new Date(r.date),"H:mm")))])]),t._v(" "),e("tr",[e("th",{staticClass:"text-left bg-gray"},[t._v("人数")]),t._v(" "),e("td",{staticClass:"bg-white"},[t._v(t._s(r.number)+"人")])])])]),t._v(" "),e("div",{staticClass:"text-center pb-3 pt-3"},[e(n.a,{staticClass:"mr-2",attrs:{small:"",color:"blue accent-4 white--text",to:"/qrcode?id="+r.id}},[t._v("QRコード")]),t._v(" "),e(n.a,{staticClass:"mr-2",attrs:{small:"",color:"blue accent-4 white--text",to:"/edit?id="+r.id}},[t._v("予約変更")]),t._v(" "),e(n.a,{attrs:{small:"",color:"blue accent-4 white--text"},on:{click:function(e){return t.openCancelOverlay(d,r.id)}}},[t._v("予約を取り消す")])],1)],1)],1)})),1)],1),t._v(" "),e(x.a),t._v(" "),e(l.a,{attrs:{cols:"12",xs:"12",sm:"12",md:"6"}},[e("h3",{staticClass:"mt-5 mb-3"},[t._v("お気に入り店舗")]),t._v(" "),e("p",[t._v(t._s(t.favoriteMessage))]),t._v(" "),e(h.a,t._l(t.favorites,(function(r){return e(l.a,{key:r.id,attrs:{cols:"12",xs:"12",sm:"6",md:"6"}},[e(o.a,{staticClass:"shop-card"},[e(d.a,{attrs:{src:"".concat(r.shops.image_url),height:"150"}}),t._v(" "),e(c.b,{staticClass:"text-h6 mt-2 shop-title"},[t._v("\n              "+t._s(r.shops.name)+"\n            ")]),t._v(" "),e(c.a,{staticClass:"mr-2 black--text shop-text"},[e("span",[t._v("#"+t._s(r.shops.area.name))]),t._v(" "),e("span",[t._v("#"+t._s(r.shops.genre.name))])]),t._v(" "),e("div",{staticClass:"d-flex align-center justify-space-between ml-3 mr-3 pb-2"},[e(n.a,{staticClass:"blue accent-4 white--text",attrs:{small:"",to:"/detail?id="+r.shops.id}},[t._v("詳しくみる")]),t._v(" "),r.user_id==t.$auth.user.id?e(_.a,{attrs:{large:"",color:"red"},on:{click:function(e){return t.unlike(r.id)}}},[t._v("mdi-cards-heart")]):e(_.a,{attrs:{large:"",color:"grey lighten-2"},on:{click:function(e){return t.like(r.shops)}}},[t._v("mdi-cards-heart")])],1)],1)],1)})),1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Logo:r(457).default,LoginMenu:r(458).default})}}]);